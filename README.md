# 🎙️ نظام حسام لتحويل النص العربي إلى صوت (V2.1 - Tortoise)

<p align="center">
  <img src="assets/logo.png" alt="شعار KH" width="100"/> <!-- تأكد من صحة المسار بعد رفع الشعار -->
</p>

<p align="center">
  <strong>🏆 صُنع بفخر لحسام فضل قدور - رمز الإرادة الخارقة والإبداع الحقيقي رغم كل التحديات 🏆</strong>
</p>
<p align="center">
  <strong>🔧 مهندس مدني تحول إلى مطوّر ذكاء اصطناعي بدون نطق | ⚙️ مهندس أصوات لا يتكلم لكنه يُسمِع العالم.</strong>
</p>
<p align="center" style="font-style: italic; color: #555;">
  "بُني هذا النظام بإرادة تتحدى كل حواجز النطق… لأجل كل من لا يُسمع صوته."
</p>

<p align="center">
  <a href="https://huggingface.co/hussamkh83" target="_blank" style="margin: 0 5px;">
    <img src="https://img.shields.io/badge/🤗%20Hugging%20Face-hussamkh83-yellow?style=flat-square" alt="Hugging Face Profile"/>
  </a>
  <img src="https://img.shields.io/github/license/housamkh83/arabic-tts-hossam?style=flat-square" alt="GitHub License">
  <img src="https://img.shields.io/badge/Python-3.9+-blue?style=flat-square&logo=python" alt="Python Version">
  <!-- أضف شارات أخرى هنا إذا أردت -->
</p>

---

## عن المشروع

هذا المشروع مفتوح المصدر يهدف لتقديم نظام متكامل لتحويل النص العربي إلى كلام (Text-to-Speech) باستخدام أحدث تقنيات الذكاء الاصطناعي. يعتمد النظام حالياً على محرك **Tortoise-TTS** المعروف بقدرته العالية على استنساخ الصوت (Voice Cloning)، مع واجهة مستخدم رسومية تفاعلية وسهلة الاستخدام مبنية باستخدام **Gradio** وموجهة بالكامل لللغة العربية.

من خلال رحلتي كمهندس مدني واجه تحديات جسدية نتيجة الحرب، وجدت في عالم البرمجة والذكاء الاصطناعي نافذة للإبداع والتعبير وتجاوز الصمت. تعلمت كل شيء بشكل ذاتي ومكثف، وهذا المشروع هو ثمرة هذه الرحلة.

يهدف هذا المستودع ليكون **مرجعاً تعليمياً وعملياً** للمطورين العرب المهتمين ببناء أنظمة TTS احترافية ومنظمة، ويشارك رحلة التغلب على التحديات التقنية والشخصية في هذا المجال، ليكون صوتاً لكل من يحلم بالإبداع رغم الظروف.

## ✨ الميزات الحالية

*   **واجهة Gradio عربية:** واجهة مستخدم رسومية تفاعلية وسهلة تمكنك من إدخال النص، اختيار الصوت المرجعي، وضبط الإعدادات بسهولة.
*   **تشكيل تلقائي للنص:** يستخدم مكتبة [mishkal](https://github.com/linuxscout/mishkal) لمحاولة إضافة التشكيل تلقائياً للنص العربي قبل المعالجة (تأكد من تثبيتها).
*   **محاولة للتحويل الصوتي:** يتضمن نظاماً **أولياً** لتحويل النص العربي (المشكول) إلى تمثيل صوتي باستخدام قواعد قابلة للتخصيص (عبر ملف `core/data/arabic_phonetic_rules.json`). *(راجع قسم القيود)*.
*   **استنساخ الصوت:** يعتمد على قدرة Tortoise-TTS القوية لاستنساخ نبرة وخصائص الصوت من ملف مرجعي قصير.
*   **تحكم في الإخراج:** يسمح بالتحكم في النبرة (عبر Temperature)، سرعة النطق، ومستوى جودة الصوت الناتج.
*   **هيكل احترافي:** تم تنظيم الكود في وحدات منفصلة (`core`, `interface`, `utils`) لسهولة الفهم، الصيانة، والتطوير المستقبلي.
*   **إعدادات خارجية:** يستخدم ملف `config.yaml` لتسهيل تعديل إعدادات التطبيق والمسارات.
*   **تسجيل مفصل (Logging):** يقوم بتسجيل خطوات التشغيل والأخطاء المحتملة في ملف (عادةً `logs/arabic_tts_app.log`) لمساعدة التصحيح.

## ⚠️ هام: القيود الحالية (Known Limitations)

يهدف هذا المشروع للشفافية الكاملة. يجب أن تكون على دراية بالقيود الحالية للنسخة التي تعتمد على Tortoise-TTS:

1.  **مشكلة النطق الإنجليزي:** محرك **Tortoise-TTS** الأساسي تم تدريبه بشكل مكثف على اللغة الإنجليزية. **حالياً، حتى مع معالجة النص العربي، لا يزال الصوت الناتج يميل بشدة إلى النطق الإنجليزي أو ينتج كلاماً غير مفهوم.** هذا قيد أساسي في النموذج نفسه يتطلب إعادة تدريب (Fine-tuning) مكثفة على بيانات عربية أو استخدام محرك مختلف (انظر الخطط المستقبلية).
2.  **التحويل الصوتي العربي:** التحويل الحالي للنص العربي إلى صوتيات (في `core/text_processor.py`)، حتى مع استخدام التشكيل من `mishkal` وقواعد JSON، لا يزال يعتبر **تمثيلاً صوتياً مبسطاً**. اللغة العربية لها قواعد صوتية معقدة تتطلب مكتبات تحويل صوتي (Phonetizer) متخصصة لتمثيلها بدقة (مثل استخدام IPA). التمثيل الحالي قد لا يكون مفهوماً بشكل صحيح بواسطة Tortoise.

**الهدف المستقبلي هو معالجة هذه القيود بشكل مباشر. هذا المستودع هو نقطة انطلاق ومرجع تعليمي للهيكل والتنظيم.**

## 🛠️ المتطلبات

*   **Python:** إصدار 3.9 أو أحدث موصى به.
*   **Git:** لتنزيل الكود.
*   **Pip:** لتثبيت المكتبات.
*   **(اختياري وموصى به بشدة للأداء):**
    *   **NVIDIA GPU:** مع ذاكرة VRAM مناسبة (يفضل 8GB أو أكثر).
    *   **CUDA Toolkit:** **إصدار 11.8 تحديداً** ليتوافق مع PyTorch المستخدم في `requirements.txt`. (إذا لم تستخدم GPU، لن تحتاج لتثبيت CUDA).
    *   **cuDNN:** (يأتي عادة مع CUDA Toolkit).
*   **(اختياري - لتجنب مشاكل بناء بعض التبعيات أحياناً):** Microsoft C++ Build Tools (يمكن تنزيلها مع Visual Studio).

## ⚙️ التثبيت

**ملاحظة مهمة:** لتجنب مشاكل التبعيات مع `deepspeed` (الذي تم إزالته من المتطلبات الأساسية ولكن قد تحتاجه Tortoise ضمنياً في بعض الحالات)، **يوصى بشدة بتثبيت PyTorch أولاً بشكل منفصل.**

### الطريقة الموصى بها (لجميع الأنظمة):

1.  **نسخ المستودع:**
    ```bash
    git clone https://github.com/housamkh83/arabic-tts-hossam.git
    cd arabic-tts-hossam
    ```
2.  **(موصى به) إنشاء وتفعيل بيئة افتراضية:**
    ```bash
    python -m venv venv
    # Windows
    venv\Scripts\activate
    # Linux / macOS
    source venv/bin/activate
    ```
3.  **تحديث pip:**
    ```bash
    python -m pip install --upgrade pip
    ```
4.  **تثبيت PyTorch (مع دعم CUDA 11.8 إذا لديك GPU):**
    ```bash
    # --- لمستخدمي NVIDIA GPU مع CUDA 11.8 ---
    pip install torch==2.0.1 torchvision torchaudio==2.0.2 --index-url https://download.pytorch.org/whl/cu118

    # --- لمستخدمي CPU فقط ---
    # pip install torch==2.0.1 torchvision torchaudio==2.0.2
    ```
    *(اختر الأمر المناسب لك. تأكد من نجاح هذه الخطوة قبل المتابعة)*

5.  **تثبيت باقي المتطلبات:**
    ```bash
    pip install -r requirements.txt
    ```
    *(سيقوم بتثبيت Gradio, Tortoise-TTS, PyYAML, Mishkal وباقي التبعيات)*

6.  **(اختياري) إضافة أصوات مرجعية:** ضع ملفات الصوت التي تريد استخدامها (بصيغة `.wav` أو `.mp3`) داخل مجلد `voices`.

### لمستخدمي Windows (باستخدام run.bat):

الملف `run.bat` يقوم بالخطوات من 2 إلى 5 المذكورة أعلاه بشكل تلقائي. فقط قم بتشغيله (بعد التأكد من تثبيت Python و Git).

## 🚀 التشغيل

1.  **تأكد من أنك داخل البيئة الافتراضية (`venv`) التي تم تثبيت المكتبات فيها.**
2.  **شغل التطبيق باستخدام:**
    ```bash
    python app.py [خيارات إضافية]
    ```
3.  **خيارات التشغيل (سطر الأوامر):**
    *   `--port <رقم>`: لتحديد منفذ مختلف (الافتراضي 7860).
    *   `--no-share`: لتعطيل رابط Gradio العام.
    *   `--auth-user <اسم> --auth-pass <كلمة>`: لتفعيل المصادقة.
    *   `--debug`: لتفعيل وضع التصحيح.
    *   `--config <مسار>`: لتحديد ملف إعدادات `config.yaml` مختلف.

## 💻 الاستخدام

1.  بعد تشغيل `app.py`، انتظر حتى ترى رسالة `Running on local URL: http://...`.
2.  افتح الرابط المحلي (عادةً `http://localhost:7860`) في متصفحك.
3.  أدخل النص العربي.
4.  اختر الصوت المرجعي من مجلد `voices`.
5.  اضبط النبرة، السرعة، والجودة.
6.  اضغط "توليد الصوت".
7.  انتظر واطلع على الحالة والصوت الناتج.

## 🔧 الإعدادات (`config.yaml`)

يمكن تعديل إعدادات التطبيق عبر ملف `config.yaml`. يشمل ذلك:

*   إعدادات Gradio (`app`).
*   مسارات المجلدات (`directories`).
*   إعدادات التسجيل (`logging`).
*   إعدادات معالجة الصوت (`audio`).
*   إعدادات محرك TTS (`tts_engine`).
*   قوائم وخيارات الواجهة (`emotion_settings`, `quality_settings`).
*   إعدادات السمة (`theme`).

*(سيتم إضافة شرح تفصيلي للإعدادات لاحقاً)*

## 📂 هيكل المشروع

arabic_tts_hossam/
│
├── app.py # نقطة الدخول الرئيسية
├── config.yaml # ملف الإعدادات
├── requirements.txt # قائمة المكتبات المطلوبة
├── run.bat # ملف تشغيل Windows
├── README.md # هذا الملف
├── LICENSE # ملف الترخيص (MIT)
│
├── core/ # المنطق الأساسي للمعالجة
│ ├── init.py
│ ├── text_processor.py
│ ├── audio_processor.py
│ ├── tts_engine.py
│ └── data/
│ └── arabic_phonetic_rules.json # قواعد التحويل الصوتي الأولية
│
├── interface/ # الواجهات ومنطق التحكم
│ ├── init.py
│ ├── tts_interface.py # الطبقة الوسيطة (Controller)
│ └── gradio_ui.py # واجهة المستخدم (View)
│
├── utils/ # أدوات مساعدة
│ ├── init.py
│ ├── logger_setup.py # إعداد نظام التسجيل
│ └── gpu_manager.py # إدارة موارد GPU
│
├── voices/ # مجلد للأصوات المرجعية (يتم إنشاؤه)
├── output/ # مجلد لحفظ المخرجات (يتم إنشاؤه)
├── logs/ # مجلد لملفات السجل (يتم إنشاؤه)
└── assets/ # (مجلد مقترح للصور والأصول الأخرى مثل الشعار)
└── logo.png # مثال لمسار الشعار
 
 
## 💡 الخطط المستقبلية

*   **[الأولوية القصوى] استبدال Tortoise-TTS:** البحث ودمج محرك TTS يدعم اللغة العربية ونقل النبرة بشكل أفضل (مثل **Coqui XTTS v2**) لحل مشكلة النطق الإنجليزي.
*   **تحسين التحويل الصوتي العربي:** دمج مكتبة Phonetizer عربية متخصصة (مثل `arabic-phonetizer`) للحصول على تمثيل صوتي دقيق (IPA) يمكن استخدامه مع المحركات المستقبلية.
*   **تحسين الواجهة:** إضافة المزيد من الخيارات، تحسين عرض التقدم والأخطاء.
*   **بناء API (اختياري):** توفير واجهة برمجية (API) باستخدام Flask أو FastAPI لدمج النظام مع تطبيقات أخرى.
*   **التوثيق المفصل:** شرح كل وحدة وكلاس في الكود بشكل أعمق.

## 🙌 المساهمة

هذا المشروع هو نتاج رحلة شخصية، ولكنه يهدف لخدمة المجتمع. نرحب بالمساهمات لتحسينه، خاصة في مجال دعم اللغة العربية بشكل أفضل! يمكنك المساهمة عن طريق:

*   فتح مشكلة (Issue) للإبلاغ عن الأخطاء أو اقتراح ميزات جديدة.
*   تقديم طلب سحب (Pull Request) مع تحسينات أو إصلاحات.
*   مشاركة خبراتك في مجال معالجة اللغة العربية أو نماذج TTS.

## 📄 الترخيص

هذا المشروع مرخص تحت ترخيص **MIT**. انظر ملف [LICENSE](LICENSE).

## 🙏 شكر وتقدير

*   لمجتمع المصادر المفتوحة الذي أتاح الأدوات والمكتبات الرائعة التي بُني عليها هذا المشروع.
*   لكل من يدعم المطورين العرب ويسعى لتقدم التقنية في منطقتنا.
*   (يمكنك إضافة شكر خاص هنا إذا أردت).

---

**"لا تدع أي تحدٍ يوقفك عن الإبداع وترك بصمتك." - حسام فضل قدور**